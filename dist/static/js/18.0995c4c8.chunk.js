(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1450:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"g",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return m}),n.d(t,"e",function(){return p}),n.d(t,"f",function(){return h}),n.d(t,"a",function(){return E}),n.d(t,"h",function(){return g});var a=n(5),c=n(31),l=(n(419),n(56)),o=n.n(l),r=n(93),i=n(24),s=function(e){return function(t){o.a.auth().onAuthStateChanged(function(n){n&&(console.log(n.uid),o.a.firestore().collection("users").doc(n.uid).get().then(function(l){console.log(l.data());var o=l.data().displayName;console.log(o);var r={uid:n.uid,displayName:o},i=c.a.firestore().collection("clients").doc().id;c.a.firestore().collection("clients").doc(i).set(Object(a.a)({},e,{id:i,authorName:r.displayName,authorId:r.uid,createdAt:new Date})).then(function(){t({type:"Add_CLIENT"})}).catch(function(e){console.error("Error adding document: ",e)})}))})}},u=function(e){return function(t){c.a.firestore().collection("clients").doc(e).delete().then(function(e){e||r.a.dispatch(i.j({message:"Ce client a \xe9t\xe9 supprim\xe9 avec succ\xe8s "}))})}},d=function(){return{type:"OPEN_DIALOG_CLIENT"}};function m(){return{type:"CLOSE_DIALOG_CLIENT"}}var f=[],p=function(){return function(e){c.a.firestore().collection("clients").get().then(function(t){return t.forEach(function(e){var t=Object(a.a)({},e.data(),{id:e.id});f.push(t)}),e(h(f)),f}).catch(function(e){console.error("Error writing document: ",e)})}},h=function(e){return{type:"GET_ALL_CLIENTS_SUCCESS",payload:e}};function E(e){return{type:"EDIT_CLIENT_ITEM",client:e}}var g=function(e){return function(t){c.a.firestore().collection("clients").doc(e.id).update(Object(a.a)({},e)).then(function(){t({type:"UPDATE_CLIENT"})}).catch(function(e){console.error("Error updating document: ",e)})}}},1569:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),l=n(16),o=n(11),r=n(12),i=n(14),s=n(13),u=n(15),d=n(1),m=n(21),f=n(18),p=(n(9),n(185)),h=n(82),E=n(30),g=n(50),b=(n(4),[{id:"nom_soc",align:"left",disablePadding:!1,label:"Nom",sort:!0},{id:"adresse_soc",align:"left",disablePadding:!1,label:"Adresse",sort:!0},{id:"SIREN",align:"left",disablePadding:!1,label:"SIREN",sort:!0},{id:"contact_tel",align:"left",disablePadding:!1,label:"T\xe9l\xe9phone",sort:!0},{id:"contact_email",align:"left",disablePadding:!1,label:"Email",sort:!0},{id:"actions",align:"left",disablePadding:!1,label:"Actions",sort:!0}]),C=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).state={selectedMenu:null},n.createSortHandler=function(e){return function(t){n.props.onRequestSort(t,e)}},n.openSelectedProductsMenu=function(e){n.setState({selectedMenu:e.currentTarget})},n.closeSelectedProductsMenu=function(){n.setState({selectedMenu:null})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onSelectAllClick,e.order),n=e.orderBy;e.numSelected,e.rowCount,e.classes,this.state.selectedMenu;return c.a.createElement(d.Y,null,c.a.createElement(d.Z,{className:"h-64"},b.map(function(e){return c.a.createElement(d.X,{key:e.id,align:e.align,padding:e.disablePadding?"none":"default",sortDirection:n===e.id&&t},e.sort&&c.a.createElement(d.eb,{title:"Sort",placement:"right"===e.align?"bottom-end":"bottom-start",enterDelay:300},c.a.createElement(d.ab,{active:n===e.id,direction:t},e.label)))},this)))}}]),t}(c.a.Component),v=Object(g.withStyles)(function(e){return{actionsButtonWrapper:{background:e.palette.background.paper}}},{withTheme:!0})(C),y=n(1450),_=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).state={order:"asc",orderBy:null,selected:[],page:0,rowsPerPage:10,statusSwitchEl:null,chatsMoreMenuEl:null,searchText:""},n.handleClick=function(e){console.log(e),n.props.EditClientItem(e)},n.handleCheck=function(e,t){var a=n.state.selected,c=a.indexOf(t),l=[];-1===c?l=l.concat(a,t):0===c?l=l.concat(a.slice(1)):c===a.length-1?l=l.concat(a.slice(0,-1)):c>0&&(l=l.concat(a.slice(0,c),a.slice(c+1))),n.setState({selected:l})},n.chatsMoreMenuClose=function(e){n.setState({chatsMoreMenuEl:null})},n.chatsMoreMenuClick=function(e){n.setState({chatsMoreMenuEl:e.currentTarget})},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.getAllClients()}},{key:"render",value:function(){var e=this,t=this.state.chatsMoreMenuEl;if(!this.props.auth.uid)return c.a.createElement(h.a,{to:"/Login"});var n=this.props.clients||[];return c.a.createElement("div",{className:"w-full flex flex-col",delay:1e3},c.a.createElement(l.a,{animation:"transition.slideUpBigIn",delay:300},c.a.createElement(d.V,{fullWidth:!0,className:"min-w-xl","aria-labelledby":"tableTitle"},c.a.createElement(l.a,{animation:"transition.slideUpBigIn",delay:300},c.a.createElement(v,null)),c.a.createElement(l.a,{animation:"transition.whirlIn",delay:400,className:"flex-grow overflow-x-auto"},c.a.createElement(d.W,null,n.map(function(n){return c.a.createElement(d.Z,{className:"h-64",hover:!0},c.a.createElement(d.X,{component:"th",scope:"row",align:"left"},n.nom_soc),c.a.createElement(d.X,{className:"truncate",component:"th",scope:"row",align:"left"},n.adresse_soc),c.a.createElement(d.X,{component:"th",scope:"row",align:"left"},n.SIREN),c.a.createElement(d.X,{component:"th",scope:"row",align:"left"},n.contact_tel),c.a.createElement(d.X,{component:"th",scope:"row",align:"left"},n.contact_email),c.a.createElement(d.X,null,c.a.createElement("div",null,c.a.createElement(d.x,{"aria-owns":t?"chats-more-menu":null,"aria-haspopup":"true",onClick:e.chatsMoreMenuClick},c.a.createElement(d.w,null,"more_vert")),c.a.createElement(d.H,{id:"chats-more-menu",anchorEl:t,open:Boolean(t),onClose:e.chatsMoreMenuClose},c.a.createElement(d.I,{onClick:e.chatsMoreMenuClose},c.a.createElement(d.F,{className:"pl-0",primary:"Supprimer",onClick:function(){e.props.removeClient(n.id)}}),c.a.createElement(d.w,{onClick:function(){e.props.removeClient(n.id)},className:"text-red text-20",align:"right"},"remove_circle")),c.a.createElement(d.I,{onClick:e.chatsMoreMenuClose},c.a.createElement(d.F,{className:"pl-0",primary:"Modifier",onClick:function(){e.handleClick(n)},component:E.a,to:"/formclient/"+n.id+"/"+n.nom_soc}),c.a.createElement(d.w,{onClick:function(){e.handleClick(n)},className:"text-blue text-20",component:E.a,to:"/formclient/"+n.id+"/"+n.nom_soc,align:"right"},"edit_circle"))))))}))))))}}]),t}(a.Component),w=Object(f.e)(Object(m.b)(function(e){return{allClients:e.clientReducer.allClients,clients:e.firestore.ordered.clients,auth:e.firebase.auth}},{getAllClients:y.e,getAllClientsSuccess:y.f,removeClient:y.g,EditClientItem:y.a,OpenRemoveClient:y.b}),Object(p.firestoreConnect)([{collection:"clients"}]))(_),N=Object(m.b)(function(e){return{mainTheme:e.fuse.settings.mainTheme}})(function(e){e.setSearchText,e.searchText,e.mainTheme,e.props;return c.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},c.a.createElement("div",{className:"flex items-center"},c.a.createElement(l.a,{animation:"transition.expandIn",delay:300},c.a.createElement(d.w,{className:"text-32 mr-0 sm:mr-12"},"shopping_basket")),c.a.createElement(l.a,{animation:"transition.slideLeftIn",delay:300},c.a.createElement(d.fb,{className:"hidden sm:flex",variant:"h6"},"Clients"))),c.a.createElement(l.a,{animation:"transition.slideRightIn",delay:300},c.a.createElement(d.c,{component:E.a,to:"/mapclient",color:"secondary",variant:"contained"},c.a.createElement("span",{className:"hidden sm:flex"},"Voir les clients en map"))),c.a.createElement(l.a,{animation:"transition.slideRightIn",delay:300},c.a.createElement(d.c,{component:E.a,to:"/formclient/client",className:"whitespace-no-wrap",variant:"contained"},c.a.createElement("span",{className:"hidden sm:flex"},"Ajouter Client"))))}),I=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).state={id:"",nom_soc:"",adresse_soc:"",SIREN:"",contact_tel:"",contact_email:""},n.updateClientState=function(){var e=n.props.clientItem;n.setState({id:e.id,nom_soc:e.nom_soc,adresse_soc:e.adresse_soc,SIREN:e.SIREN,contact_tel:e.contact_tel,contact_email:e.contact_email})},n.closeDialog=function(){n.props.closeDialogClient()},n.handleSubmit=function(){console.log(n.state);var e=n.props.clientItem;n.props.removeClient(e.id)},n}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.updateClientState(),console.log("je trouve",this.props.clientItem)}},{key:"render",value:function(){var e=this.props,t=e.todoDialog,n=e.clientItem;return c.a.createElement(d.j,Object.assign({},t.props,{onClose:this.closeDialog}),c.a.createElement(d.a,{position:"static"},c.a.createElement(d.db,null,c.a.createElement(d.fb,{color:"inherit"},"\xcates-vous s\xfbr de vouloir supprimer ",n.nom_soc," ?"))),c.a.createElement(d.k,{className:"justify-center"},c.a.createElement(d.x,{color:"secondary",onClick:this.handleSubmit},c.a.createElement(d.w,null,"done")),c.a.createElement(d.x,{color:"primary",onClick:this.closeDialog},c.a.createElement(d.w,null,"close"))))}}]),t}(a.Component),S=Object(m.b)(function(e){return console.log("Item",e),{todoDialog:e.clientReducer.todoDialog,clientItem:e.clientReducer.clientItem,clients:e.firestore.ordered.clients}},{removeClient:y.g,closeDialogClient:y.d})(I);t.default=Object(f.e)(Object(m.b)(function(e){return{clients:e.firestore.ordered.clients}},null),Object(p.firestoreConnect)([{collection:"clients"}]))(function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(l.m,{classes:{content:"flex",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:c.a.createElement(N,null),content:c.a.createElement(w,null),innerScroll:!0}),c.a.createElement(S,null))})}}]);