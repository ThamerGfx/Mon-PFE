(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1458:function(e,t,a){"use strict";a.d(t,"b",function(){return c}),a.d(t,"a",function(){return u}),a.d(t,"c",function(){return d}),a.d(t,"d",function(){return g}),a.d(t,"e",function(){return f});var s=a(5),n=a(31),o=(a(419),a(56)),i=a.n(o),l=a(93),r=a(24),c=function(e){return function(t){i.a.auth().onAuthStateChanged(function(t){t&&(console.log(t.uid),i.a.firestore().collection("users").doc(t.uid).get().then(function(a){console.log(a.data());var o=a.data(),i=o.displayName,c=o.email_user;console.log(i);var u={uid:t.uid,displayName:i,email_user:c},d=n.a.firestore().collection("messages").doc().id;n.a.firestore().collection("messages").doc(d).set(Object(s.a)({},e,{id:d,authorName:u.displayName,authorId:u.uid,authorEmail:u.email_user,createdAt:new Date})).then(function(e){e||l.a.dispatch(r.j({message:"Message envoy\xe9"}))}).catch(function(e){console.error("Error adding document: ",e)})}))})}},u=function(){return console.log("open dialog message"),{type:"OPEN_DIALOG_MESSAGE"}},d=function(){return{type:"CLOSE_DIALOG_MESSAGE"}},m=[],g=function(){return function(e){i.a.auth().onAuthStateChanged(function(t){t&&(console.log(t.uid),i.a.firestore().collection("users").doc(t.uid).get().then(function(a){console.log(a.data());var o=a.data().displayName;console.log(o);t.uid!==m.authorId&&n.a.firestore().collection("messages").get().then(function(t){return t.forEach(function(e){var t=Object(s.a)({},e.data(),{id:e.id});m.push(t)}),e(f(m)),m}).catch(function(e){console.error("Error writing document: ",e)})}))})}},f=function(e){return{type:"GET_ALL_MESSAGES_SUCCESS",payload:e}}},1564:function(e,t,a){"use strict";a.r(t);var s=a(34),n=a(11),o=a(12),i=a(14),l=a(13),r=a(15),c=a(0),u=a.n(c),d=a(1),m=a(21),g=(a(9),a(1458)),f=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={id:"",dist:"",msg:""},a.updateMessageState=function(){"message"===a.props.match.params.messageId&&a.setState({id:"",dist:"",msg:""})},a.closeMessage=function(){a.props.closeDialogMessage()},a.handleChange=function(e){a.setState(Object(s.a)({},e.target.id,e.target.value))},a.handleSend=function(){console.log(a.state),a.props.addMessage(a.state),a.setState({id:"",dist:"",msg:""})},a.handleUpdate=function(){console.log(a.state),a.props.updateFormation(a.state)},a.closeDialog=function(){a.props.closeDialogMessage()},a}return Object(r.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.updateMessageState(),console.log("je trouve",this.props.messageItem)}},{key:"render",value:function(){var e=this,t=this.props.todoDialog;return u.a.createElement(d.j,Object.assign({},t.props,{onClose:this.closeDialog,fullWidth:!0,maxWidth:"sm"}),u.a.createElement(d.a,{position:"static",elevation:1},u.a.createElement(d.db,{className:"flex w-full"},u.a.createElement(d.fb,{variant:"subtitle1",color:"inherit"},"Envoyer un"))),u.a.createElement(d.l,{classes:{root:"p-0"}},u.a.createElement("div",{className:"px-16 sm:px-24"},u.a.createElement(d.q,{className:"mt-8 mb-16",required:!0,fullWidth:!0},u.a.createElement(d.cb,{className:"mt-8 mb-16",id:"dist",name:"dist",onChange:this.handleChange,label:"Email de destinataire",type:"text",value:this.state.dist,multiline:!0,variant:"outlined",fullWidth:!0,required:!0})),u.a.createElement(d.q,{className:"mt-8 mb-16",required:!0,fullWidth:!0},u.a.createElement(d.cb,{className:"mt-8 mb-16",id:"msg",name:"msg",onChange:this.handleChange,label:"Message",type:"text",value:this.state.msg,variant:"outlined",fullWidth:!0,multiline:!0,rows:5})))),u.a.createElement(d.k,{className:"justify-between pl-8 sm:pl-16"},u.a.createElement(d.c,{variant:"contained",color:"primary",onClick:function(){e.handleSend(),e.props.closeDialogMessage()}},"Send")))}}]),t}(c.Component);t.default=Object(m.b)(function(e){return console.log("Item",e),{todoDialog:e.messageReducer.todoDialog,allMessages:e.messageReducer.allMessages,messages:e.firestore.ordered.messages,messageItem:e.messageReducer.messageItem,auth:e.firebase.auth}},{addMessage:g.b,getAllMessages:g.d,getAllMessagesSuccess:g.e,closeDialogMessage:g.c})(f)}}]);