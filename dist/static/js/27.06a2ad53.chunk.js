(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1458:function(e,t,a){"use strict";a.d(t,"b",function(){return c}),a.d(t,"a",function(){return d}),a.d(t,"c",function(){return m}),a.d(t,"d",function(){return g}),a.d(t,"e",function(){return h});var n=a(5),s=a(31),i=(a(419),a(56)),o=a.n(i),l=a(93),r=a(24),c=function(e){return function(t){o.a.auth().onAuthStateChanged(function(t){t&&(console.log(t.uid),o.a.firestore().collection("users").doc(t.uid).get().then(function(a){console.log(a.data());var i=a.data(),o=i.displayName,c=i.email_user;console.log(o);var d={uid:t.uid,displayName:o,email_user:c},m=s.a.firestore().collection("messages").doc().id;s.a.firestore().collection("messages").doc(m).set(Object(n.a)({},e,{id:m,authorName:d.displayName,authorId:d.uid,authorEmail:d.email_user,createdAt:new Date})).then(function(e){e||l.a.dispatch(r.j({message:"Message envoy\xe9"}))}).catch(function(e){console.error("Error adding document: ",e)})}))})}},d=function(){return console.log("open dialog message"),{type:"OPEN_DIALOG_MESSAGE"}},m=function(){return{type:"CLOSE_DIALOG_MESSAGE"}},u=[],g=function(){return function(e){o.a.auth().onAuthStateChanged(function(t){t&&(console.log(t.uid),o.a.firestore().collection("users").doc(t.uid).get().then(function(a){console.log(a.data());var i=a.data().displayName;console.log(i);t.uid!==u.authorId&&s.a.firestore().collection("messages").get().then(function(t){return t.forEach(function(e){var t=Object(n.a)({},e.data(),{id:e.id});u.push(t)}),e(h(u)),u}).catch(function(e){console.error("Error writing document: ",e)})}))})}},h=function(e){return{type:"GET_ALL_MESSAGES_SUCCESS",payload:e}}},1563:function(e,t,a){"use strict";a.r(t);var n=a(34),s=a(11),i=a(12),o=a(14),l=a(13),r=a(15),c=a(0),d=a.n(c),m=a(1),u=a(16),g=a(82),h=a(30),f=(a(9),a(21)),p=(a(129),a(1458)),E=function(e){function t(){var e,a;Object(s.a)(this,t);for(var i=arguments.length,r=new Array(i),c=0;c<i;c++)r[c]=arguments[c];return(a=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={id:"",dist:"",msg:""},a.updateMessageState=function(){"message"===a.props.match.params.messageId&&a.setState({id:"",dist:"",msg:""})},a.handleChange=function(e){a.setState(Object(n.a)({},e.target.id,e.target.value))},a.handleSend=function(){console.log(a.state),a.props.addMessage(a.state),a.setState({id:"",dist:"",msg:""})},a}return Object(r.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.updateMessageState(),console.log("je trouve",this.props.messageItem)}},{key:"render",value:function(){return this.props.auth.uid?d.a.createElement(u.m,{classes:{toolbar:"p-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:d.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},d.a.createElement("div",{className:"flex flex-col items-start max-w-full"},d.a.createElement(u.a,{animation:"transition.slideRightIn",delay:300},d.a.createElement(m.fb,{className:"normal-case flex items-center sm:mb-12",component:h.a,role:"button",to:"/profile"},d.a.createElement(m.w,{className:"mr-4 text-20"},"arrow_back"),"Message")),d.a.createElement("div",{className:"flex items-center max-w-full"},d.a.createElement("div",{className:"flex flex-col min-w-0"},d.a.createElement(u.a,{animation:"transition.slideLeftIn",delay:300},d.a.createElement(m.fb,{variant:"caption"},"Message Details"))))),d.a.createElement("div",null,d.a.createElement(u.a,{animation:"transition.slideRightIn",delay:300},"message"===this.props.match.params.messageId?d.a.createElement(m.c,{className:"whitespace-no-wrap",variant:"contained",onClick:this.handleSend},"Send"):d.a.createElement(m.c,{className:"whitespace-no-wrap",variant:"contained",onClick:this.handleSend,component:h.a,to:"/profile"},"Reply")))),content:d.a.createElement("div",{className:"p-16 sm:p-24 max-w-2xl"},d.a.createElement("form",null,d.a.createElement(u.a,{animation:"transition.bounceUpIn",delay:1e3},d.a.createElement(m.cb,{className:"mt-8 mb-16",id:"dist",name:"dist",onChange:this.handleChange,label:"Email de destinataire",type:"text",value:this.state.dist,multiline:!0,variant:"outlined",fullWidth:!0,required:!0})),d.a.createElement(u.a,{animation:"transition.bounceUpIn",delay:800},d.a.createElement(m.cb,{className:"mt-8 mb-16",id:"msg",name:"msg",onChange:this.handleChange,label:"Message",type:"text",value:this.state.msg,variant:"outlined",fullWidth:!0,multiline:!0,rows:5})))),innerScroll:!0}):d.a.createElement(g.a,{to:"/Login"})}}]),t}(c.Component);t.default=Object(f.b)(function(e){return console.log(e),{allMessages:e.messageReducer.allMessages,messages:e.firestore.ordered.messages,messageItem:e.messageReducer.messageItem,auth:e.firebase.auth}},{addMessage:p.b,getAllMessages:p.d,getAllMessagesSuccess:p.e})(E)}}]);